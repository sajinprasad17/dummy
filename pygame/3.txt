package runner;

import java.io.IOException;
import java.net.MalformedURLException;

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.Select;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;
import com.aventstack.extentreports.model.ScreenCapture;

import utils.Base;
import utils.ExcelReader;
import utils.Reporter;
import utils.Screenshot;
import utils.WebDriverHelper;

public class TestSample extends Base {

    WebDriverHelper helper=null;
    Actions actions=null;
    ExtentReports extent=null;
    ExtentTest test=null;
    

    @BeforeMethod
    public void launchBrowser() throws MalformedURLException {
    
        openBrowser();
        extent=Reporter.generateExtentReport("Demo report");
        helper=new WebDriverHelper(driver);
        actions=new Actions(driver);
    }

    @Test
    public void testOne() throws IOException{

        test=extent.createTest("Sample Test");
        try{

        driver.findElement(By.xpath("//input[@id=\"first_name\"]")).sendKeys("FirstName");

        WebElement sur=driver.findElement(By.xpath("//input[@id=\"last_name\"]"));
        String value=ExcelReader.readdata("./testdata/testdata.xlsx", "Sheet1", 0, 0);
        sur.sendKeys(value);

        WebElement em=driver.findElement(By.xpath("//input[@id=\"email\"]"));
        em.sendKeys("user002@email.com");

        WebElement drop=driver.findElement(By.xpath("//select[@id=\"role_option\"]"));
        drop.click();
        Select select=new Select(drop);
        select.selectByVisibleText("Director");



        WebElement coun=driver.findElement(By.xpath("//select[@id=\"country_option\"]"));
        coun.click();
        Select sel2=new Select(coun);
        sel2.selectByIndex(0);

        test.pass("Screenshot");
        Screenshot.getScreenShot(driver, "sample.png");
        Reporter.attachScreenshotToReport(test, driver, "sample");


        }
        catch(Exception e)
        {
            e.printStackTrace();
        }

    }
        

    @AfterMethod
    public void tearDown() {
        if(driver!=null)
        {
            driver.quit();
        }
         if (extent != null) {
            extent.flush();
}

    }
}